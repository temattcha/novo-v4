"use strict";(self["webpackChunknvs_v4"]=self["webpackChunknvs_v4"]||[]).push([[1601],{654:function(t,e,a){a.r(e),a.d(e,{default:function(){return y}});var s=a(4177),l=a(7179),i=a(3385),r=a(5223),o=a(4437),n=a(6035),c=a(5408),d=a(7345),u=a(6904),p=a(5057),h=a(1908),A=a(7659),m=a(1302),v=a(5294),D=a(6883),S=a(4397),T=a(5234),g=a(5251),f=function(){var t=this,e=t._self._c;return e("div",[e(n.Z,[e(v.Z,[e(o.Z,{attrs:{cols:"12"}},[e(i.Z,{staticClass:"mx-auto",attrs:{"max-width":"650"}},[e(u.Z,[e(r.EB,[e("span",{staticClass:"text-h4 text-md-h3"},[t._v("Relatório de Lançamentos")])]),e(r.ZB,[e(n.Z,[e(v.Z,{attrs:{justify:"center"}},[e(o.Z,{attrs:{cols:"12",sm:"6",md:"12"}},[e(s.Z,{staticClass:"grey-label",attrs:{items:t.companies,color:"blue",outlined:"","hide-details":"",label:"Empresa","prepend-icon":"mdi-office-building-outline","item-text":"EMPRESA","item-value":"EMPRESA"},on:{keyup:function(e){t.company=t.company.toLowerCase().split(" ").map((t=>t.charAt(0).toUpperCase()+t.substring(1))).join(" ")}},scopedSlots:t._u([{key:"no-data",fn:function(){return[e(h.Z,[e(A.V9,[t._v(" Nenhum item encontrado "),e("br"),e("br"),e(m.Z,{attrs:{indeterminate:"",color:"blue"}})],1)],1)]},proxy:!0}]),model:{value:t.company,callback:function(e){t.company=e},expression:"company"}})],1),e(o.Z,{attrs:{cols:"12",sm:"6",md:"12"}},[e(s.Z,{staticClass:"grey-label",attrs:{items:t.company?t.plates:t.companies,color:"blue",outlined:"","hide-details":"",label:"Placa","prepend-icon":"mdi-account-outline","item-text":"PLACA","item-value":"PLACA",onkeyup:"this.value = this.value.toUpperCase()"},scopedSlots:t._u([{key:"no-data",fn:function(){return[e(h.Z,[e(A.V9,[t._v(" Nenhum item encontrado "),e("br"),e("br"),e(m.Z,{attrs:{indeterminate:"",color:"blue"}})],1)],1)]},proxy:!0}]),model:{value:t.plate,callback:function(e){t.plate=e},expression:"plate"}})],1),e(o.Z,{attrs:{cols:"12",md:"6"}},[e(D.Z,{staticClass:"grey-label",attrs:{color:"blue","hide-details":"",items:t.states,"prepend-icon":"mdi-map-marker-outline",label:"Estado",placeholder:"Selecione",outlined:""},model:{value:t.state,callback:function(e){t.state=e},expression:"state"}})],1),e(o.Z,{attrs:{cols:"12",md:"6"}},[e(D.Z,{staticClass:"grey-label",attrs:{color:"blue","prepend-icon":"mdi-list-status","hide-details":"",multiple:"",items:t.statuses,label:"Status",placeholder:"Selecione",outlined:""},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}})],1),e(o.Z,{attrs:{cols:"12",sm:"6"}},[e(g.Z,{staticClass:"my-0 ms-2 pa-0",attrs:{readonly:"",outlined:"","hide-details":"","max-width":"100",label:"Início"},model:{value:t.computedDateFormatted1,callback:function(e){t.computedDateFormatted1=e},expression:"computedDateFormatted1"}}),e(d.Z,{staticClass:"ma-0 pa-0 mx-auto",attrs:{color:"amber",locale:"pt-BR","no-title":""},model:{value:t.date1,callback:function(e){t.date1=e},expression:"date1"}})],1),e(o.Z,{attrs:{cols:"12",sm:"6"}},[e(g.Z,{staticClass:"my-0 ms-2 pa-0",attrs:{readonly:"",outlined:"","hide-details":"","max-width":"100",label:"Final"},model:{value:t.computedDateFormatted2,callback:function(e){t.computedDateFormatted2=e},expression:"computedDateFormatted2"}}),e(d.Z,{staticClass:"ma-0 pa-0 mx-auto",attrs:{color:"amber",locale:"pt-BR","no-title":""},model:{value:t.date2,callback:function(e){t.date2=e},expression:"date2"}})],1)],1)],1)],1),e(r.h7,{staticClass:"mt-n10 px-10 py-5"},[e(l.Z,{attrs:{fab:"",small:"",disabled:!t.licences,loading:t.loading2},on:{click:function(e){return t.downloadPDF()}}},[e(p.Z,{attrs:{dark:"",color:"red darken-2"}},[t._v(" mdi-file-pdf-box ")])],1),e(l.Z,{attrs:{fab:"",small:"",disabled:!t.licences,loading:t.loading3},on:{click:function(e){return t.downloadXLSX("xlsx")}}},[e(p.Z,{attrs:{dark:"",color:"green darken-2"}},[t._v(" mdi-microsoft-excel ")])],1),e(T.Z),e(l.Z,{attrs:{color:"blue darken-3 white--text",loading:t.loading},on:{click:function(e){t.generateReport(),t.loading=!0}}},[t._v(" Gerar Relatório ")])],1)],1)],1)],1)],1),e(v.Z,[!0===t.showReport?e(n.Z,[e(c.Z,{attrs:{headers:t.headers,items:t.licences,"footer-props":{itemsPerPageOptions:[5,10,-1]}}})],1):t._e()],1)],1),e("vue-html2pdf",{ref:"html2Pdf",attrs:{"show-layout":!1,"enable-download":!0,"manual-pagination":!1,"paginate-elements-by-height":14001,filename:t.reportName,"pdf-quality":2,"pdf-format":"a4","pdf-orientation":"landscape","pdf-content-width":"100%"},on:{startPagination:function(e){t.loading2=!0},hasDownloaded:function(e){t.loading2=!1}}},[e("section",{attrs:{slot:"pdf-content"},slot:"pdf-content"},[e(v.Z,[e(o.Z,{attrs:{cols:"12"}},[e(S.Z,[e("thead",[e("tr",[e("th",[t._v("Custo")]),e("th",[t._v("Receita")]),e("th",[t._v("Saldo")])])]),e("tbody",[e("tr",[e("td",[t._v(t._s(t.totalCost))]),e("td",[t._v(t._s(t.totalRev))]),e("td",[t._v(t._s(t.totalProfit))])])])])],1),e("hr"),e(o.Z,{attrs:{cols:"12"}},[!0===t.showReport?e(n.Z,[e(c.Z,{attrs:{headers:t.headers,items:t.licences,"footer-props":{itemsPerPageOptions:[-1]}}})],1):t._e()],1)],1)],1)]),e("table",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"exportableTable"},[e("tr",t._l(t.headers,(function(a,s){return e("th",{key:"header"+s},[t._v(" "+t._s(a.text)+" ")])})),0),t._l(t.licences,(function(a,s){return e("tr",{key:"data"+s},[e("td",[t._v(t._s(t.usDate(a.DATA)))]),e("td",[t._v(t._s(a.EMPRESA))]),e("td",[t._v(t._s(a.ESTADO))]),e("td",[t._v(t._s(a.PLACA))]),e("td",[t._v(t._s(a.AET))]),e("td",[t._v(t._s(a.STATUS))]),e("td",[t._v(t._s(a.CUSTOTAXA.replace("R$ ","").replace(",",".")))]),e("td",[t._v(t._s(a.VALORCOBRADO.replace("R$ ","").replace(",",".")))]),e("td",[t._v(t._s(a.NUMBOLETO))]),e("td",[t._v(t._s(a.VENCIMENTOBOLETO))])])})),e("tr",[e("td",[t._v("Custo")]),e("td",[t._v(t._s(t.totalCost))])]),e("tr",[e("td",[t._v("Faturamento")]),e("td",[t._v(t._s(t.totalRev))])]),e("tr",[e("td",[t._v("Saldo")]),e("td",[t._v(t._s(t.totalProfit))])])],2)],1)},x=[],R=a(594),E=a(2074),C=a(4105),P={name:"FinancialReportAdmin",components:{VueHtml2pdf:E.Z},data:()=>({company:"",state:"",plate:"",status:"",table:"",dateFormatted:"",reportName:"",showReport:!1,licences:null,totals:null,totalCost:null,totalProfit:null,totalRev:null,repeated:!1,loading:!1,loading2:!1,loading3:!1,sevenAgo:new Date((new Date).setDate(new Date(new Date).getDate()-7)).toISOString().substr(0,10),date1:new Date((new Date).getFullYear(),(new Date).getMonth(),1).toISOString().substr(0,10),date2:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),companies:[],plates:[],states:[{value:"",text:"Selecione"},{value:"FEDERAL",text:"FEDERAL"},{value:"BA",text:"Bahia"},{value:"GO",text:"Goiás"},{value:"MG",text:"Minas Gerais"},{value:"MS",text:"Mato Grosso do Sul"},{value:"PE",text:"Pernambuco"},{value:"PR",text:"Paraná"},{value:"RJ",text:"Rio de Janiero"},{value:"RS",text:"Rio Grande do Sul"},{value:"SC",text:"Santa Catarina"},{value:"SP",text:"São Paulo"},{value:"TO",text:"Tocantins"},{value:"AC",text:"Acre"},{value:"AL",text:"Alagoas"},{value:"AM",text:"Amazonas"},{value:"AP",text:"Amapá"},{value:"CE",text:"Ceará"},{value:"DF",text:"Distrito Federal"},{value:"ES",text:"Espirito Santo"},{value:"MA",text:"Maranhão"},{value:"MT",text:"Mato Grosso"},{value:"PA",text:"Pará"},{value:"PB",text:"Paraíba"},{value:"PI",text:"Piauí"},{value:"RN",text:"Rio Grande do Norte"},{value:"RO",text:"Rondônia"},{value:"RR",text:"Roraima"},{value:"SE",text:"Sergipe"}],headers:[{text:"ID",value:"ID"},{text:"Data",value:"DATA"},{text:"Empresa",value:"EMPRESA"},{text:"UF",value:"ESTADO"},{text:"Placa",value:"PLACA"},{text:"Nº AET",value:"AET"},{text:"Status",value:"STATUS"},{text:"Custo",value:"CUSTOTAXA"},{text:"Nº Boleto",value:"NUMBOLETO"},{text:"Vencimento Boleto",value:"VENCIMENTOBOLETO"},{text:"Valor Cobrado",value:"VALORCOBRADO"}],statuses:[{value:"A VENCER",text:"A Vencer"},{value:"TAXA PAGA",text:"Taxa Paga"},{value:"CONFERIR",text:"Conferir"},{value:"PAGO",text:"Pago"},{value:"A COBRAR",text:"A Cobrar"},{value:"VENCIDO",text:"Vencido"},{value:"RENEGOCIADO",text:"Renegociado"},{value:"NÃO COBRAR",text:"Não Cobrar"},{value:"A DEPOSITAR",text:"A Depositar"},{value:"ACERTO",text:"Acerto"}]}),computed:{computedDateFormatted1(){return this.formatDate(this.date1)},computedDateFormatted2(){return this.formatDate(this.date2)}},watch:{company(){let t=this.companies.filter((t=>t.EMPRESA===this.company));return this.plates=t,this.plates},date1(){this.dateFormatted=this.formatDate(this.date1)},date2(){this.dateFormatted=this.formatDate(this.date2)},licences(){return this.reportName="Relatório NVS "+this.date2}},created(){this.fetchCompanies()},methods:{fetchCompanies(){return fetch("https://sheetdb.io/api/v1/afxq0nl1f0gvg").then((t=>t.json())).then((t=>{this.companies=t}))},formatDate(t){if(!t)return null;var[e,a,s]=t.split("-");return`${s.padStart(2,"0")}/${a.padStart(2,"0")}/${e}`},parseDate(t){if(!t)return null;const[e,a,s]=t.split("/");return`${s}-${a.padStart(2,"0")}-${e.padStart(2,"0")}`},usDate(t){if(!t)return null;const[e,a,s]=t.split("/");var l="00:00:28";return`${a.padStart(2,"0")}/${e.padStart(2,"0")}/${s} ${l}`},fetchLicences(){return R.Z.get("https://sheetdb.io/api/v1/afxq0nl1f0gvg")},generateReport(){this.fetchLicences().then((t=>{var e=t.data;this.$nextTick((()=>{var t="",a="",s="",l="",i="",r="",o="",n="",c="",d="",u="";t=e.filter((t=>t.EMPRESA.includes(this.company)&&t.PLACA.includes(this.plate)&&t.ESTADO.includes(this.state)&&t.STATUS.includes(this.status)&&this.parseDate(t.DATA).replace(/-/g,"")>=this.date1.replace(/-/g,"")&&this.parseDate(t.DATA).replace(/-/g,"")<=this.date2.replace(/-/g,""))),a=e.filter((t=>t.EMPRESA.includes(this.company)&&t.PLACA.includes(this.plate)&&t.ESTADO.includes(this.state)&&t.STATUS.includes(this.status[0])&&this.parseDate(t.DATA).replace(/-/g,"")>=this.date1.replace(/-/g,"")&&this.parseDate(t.DATA).replace(/-/g,"")<=this.date2.replace(/-/g,""))),s=e.filter((t=>t.EMPRESA.includes(this.company)&&t.PLACA.includes(this.plate)&&t.ESTADO.includes(this.state)&&t.STATUS.includes(this.status[1])&&this.parseDate(t.DATA).replace(/-/g,"")>=this.date1.replace(/-/g,"")&&this.parseDate(t.DATA).replace(/-/g,"")<=this.date2.replace(/-/g,""))),l=e.filter((t=>t.EMPRESA.includes(this.company)&&t.PLACA.includes(this.plate)&&t.ESTADO.includes(this.state)&&t.STATUS.includes(this.status[2])&&this.parseDate(t.DATA).replace(/-/g,"")>=this.date1.replace(/-/g,"")&&this.parseDate(t.DATA).replace(/-/g,"")<=this.date2.replace(/-/g,""))),i=e.filter((t=>t.EMPRESA.includes(this.company)&&t.PLACA.includes(this.plate)&&t.ESTADO.includes(this.state)&&t.STATUS.includes(this.status[3])&&this.parseDate(t.DATA).replace(/-/g,"")>=this.date1.replace(/-/g,"")&&this.parseDate(t.DATA).replace(/-/g,"")<=this.date2.replace(/-/g,""))),r=e.filter((t=>t.EMPRESA.includes(this.company)&&t.PLACA.includes(this.plate)&&t.ESTADO.includes(this.state)&&t.STATUS.includes(this.status[4])&&this.parseDate(t.DATA).replace(/-/g,"")>=this.date1.replace(/-/g,"")&&this.parseDate(t.DATA).replace(/-/g,"")<=this.date2.replace(/-/g,""))),r=e.filter((t=>t.EMPRESA.includes(this.company)&&t.PLACA.includes(this.plate)&&t.ESTADO.includes(this.state)&&t.STATUS.includes(this.status[4])&&this.parseDate(t.DATA).replace(/-/g,"")>=this.date1.replace(/-/g,"")&&this.parseDate(t.DATA).replace(/-/g,"")<=this.date2.replace(/-/g,""))),o=e.filter((t=>t.EMPRESA.includes(this.company)&&t.PLACA.includes(this.plate)&&t.ESTADO.includes(this.state)&&t.STATUS.includes(this.status[5])&&this.parseDate(t.DATA).replace(/-/g,"")>=this.date1.replace(/-/g,"")&&this.parseDate(t.DATA).replace(/-/g,"")<=this.date2.replace(/-/g,""))),n=e.filter((t=>t.EMPRESA.includes(this.company)&&t.PLACA.includes(this.plate)&&t.ESTADO.includes(this.state)&&t.STATUS.includes(this.status[6])&&this.parseDate(t.DATA).replace(/-/g,"")>=this.date1.replace(/-/g,"")&&this.parseDate(t.DATA).replace(/-/g,"")<=this.date2.replace(/-/g,""))),c=e.filter((t=>t.EMPRESA.includes(this.company)&&t.PLACA.includes(this.plate)&&t.ESTADO.includes(this.state)&&t.STATUS.includes(this.status[7])&&this.parseDate(t.DATA).replace(/-/g,"")>=this.date1.replace(/-/g,"")&&this.parseDate(t.DATA).replace(/-/g,"")<=this.date2.replace(/-/g,""))),d=e.filter((t=>t.EMPRESA.includes(this.company)&&t.PLACA.includes(this.plate)&&t.ESTADO.includes(this.state)&&t.STATUS.includes(this.status[8])&&this.parseDate(t.DATA).replace(/-/g,"")>=this.date1.replace(/-/g,"")&&this.parseDate(t.DATA).replace(/-/g,"")<=this.date2.replace(/-/g,""))),u=e.filter((t=>t.EMPRESA.includes(this.company)&&t.PLACA.includes(this.plate)&&t.ESTADO.includes(this.state)&&t.STATUS.includes(this.status[9])&&this.parseDate(t.DATA).replace(/-/g,"")>=this.date1.replace(/-/g,"")&&this.parseDate(t.DATA).replace(/-/g,"")<=this.date2.replace(/-/g,""))),0===this.status.length?this.licences=t:this.licences=a.concat(s).concat(l).concat(i).concat(r).concat(o).concat(n).concat(c).concat(d).concat(u);const p=this.licences.reduce(((t,e)=>(e.CUSTOTAXA||(e.CUSTOTAXA="R$ 0,00"),parseFloat(e.CUSTOTAXA.replace("R$ ","").replace(".","").replace(",","."))+t)),0),h=this.licences.reduce(((t,e)=>(e.VALORCOBRADO||(e.VALORCOBRADO="R$ 0,00"),t+parseFloat(e.VALORCOBRADO.replace("R$ ","").replace(".","").replace(",",".")))),0);this.totalCost=new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(p),this.totalRev=new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(h),this.totalProfit=new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(h.toFixed(2)-p.toFixed(2)),this.showReport=!0,this.loading=!1}))}))},downloadPDF(){this.$refs.html2Pdf.generatePdf()},downloadXLSX(t,e,a){var s=this.$refs.exportableTable,l=C.P6.table_to_book(s,{sheet:"Relatório"});this.loading3=!0,setTimeout((()=>(this.loading3=!1,a?C.cW(l,{bookType:t,bookSTT:!0,type:"string"}):C.NC(l,e||this.reportName+"."+(t||"xlsx")))),100)}}},b=P,O=a(1001),_=(0,O.Z)(b,f,x,!1,null,null,null),y=_.exports}}]);
//# sourceMappingURL=views-FinancialReportAdmin.1ead0ca6.js.map