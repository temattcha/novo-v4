"use strict";(self["webpackChunknvs_v4"]=self["webpackChunknvs_v4"]||[]).push([[5932],{8235:function(t,e,a){a.r(e),a.d(e,{default:function(){return w}});var s=a(4177),l=a(7179),i=a(3385),o=a(5223),n=a(4437),r=a(6035),d=a(5408),c=a(7345),u=a(6904),p=a(5057),h=a(1908),m=a(7659),f=a(1302),v=a(5294),S=a(6883),A=a(5234),x=a(5251),g=function(){var t=this,e=t._self._c;return e("div",[e(r.Z,[e(v.Z,[e(n.Z,{attrs:{cols:"12"}},[e(i.Z,{staticClass:"mx-auto",attrs:{"max-width":"650"}},[e(u.Z,[e(o.EB,[e("span",{staticClass:"text-h4 text-md-h3"},[t._v("Relatório de Lançamentos")])]),e(o.ZB,[e(r.Z,[e(v.Z,{attrs:{justify:"center"}},[e(n.Z,{attrs:{cols:"12",sm:"6",md:"12"}},[e(s.Z,{staticClass:"grey-label",attrs:{items:t.companies,color:"blue",outlined:"","hide-details":"",label:"Empresa","prepend-icon":"mdi-office-building-outline","item-text":"EMPRESA","item-value":"EMPRESA"},scopedSlots:t._u([{key:"no-data",fn:function(){return[e(h.Z,[e(m.V9,[t._v(" Nenhum item encontrado "),e("br"),e("br"),e(f.Z,{attrs:{indeterminate:"",color:"blue"}})],1)],1)]},proxy:!0}]),model:{value:t.company,callback:function(e){t.company=e},expression:"company"}})],1),e(n.Z,{attrs:{cols:"12",md:"6"}},[e(S.Z,{staticClass:"grey-label",attrs:{color:"blue","hide-details":"",items:t.aetStates,"prepend-icon":"mdi-map-marker-outline",label:"Estado",placeholder:"Selecione",outlined:""},model:{value:t.aetState,callback:function(e){t.aetState=e},expression:"aetState"}})],1),e(n.Z,{attrs:{cols:"12",md:"6"}},[e(S.Z,{staticClass:"grey-label",attrs:{color:"blue","prepend-icon":"mdi-list-status","hide-details":"",multiple:"",items:t.statuses,label:"Status",placeholder:"Selecione",outlined:""},model:{value:t.aetStatus,callback:function(e){t.aetStatus=e},expression:"aetStatus"}})],1),e(n.Z,{attrs:{cols:"12",sm:"6"}},[e(x.Z,{staticClass:"my-0 ms-2 pa-0",attrs:{readonly:"",outlined:"","hide-details":"","max-width":"100",label:"Início"},model:{value:t.computedDateFormatted1,callback:function(e){t.computedDateFormatted1=e},expression:"computedDateFormatted1"}}),e(c.Z,{staticClass:"ma-0 pa-0 mx-auto",attrs:{color:"amber",locale:"pt-BR","no-title":""},model:{value:t.date1,callback:function(e){t.date1=e},expression:"date1"}})],1),e(n.Z,{attrs:{cols:"12",sm:"6"}},[e(x.Z,{staticClass:"my-0 ms-2 pa-0",attrs:{readonly:"",outlined:"","hide-details":"","max-width":"100",label:"Final"},model:{value:t.computedDateFormatted2,callback:function(e){t.computedDateFormatted2=e},expression:"computedDateFormatted2"}}),e(c.Z,{staticClass:"ma-0 pa-0 mx-auto",attrs:{color:"amber",locale:"pt-BR","no-title":""},model:{value:t.date2,callback:function(e){t.date2=e},expression:"date2"}})],1)],1)],1)],1),e(o.h7,{staticClass:"mt-n10 px-10 py-5"},[e(l.Z,{attrs:{fab:"",small:"",disabled:!t.licences,loading:t.loading2},on:{click:function(e){return t.downloadPDF()}}},[e(p.Z,{attrs:{dark:"",color:"red darken-2"}},[t._v(" mdi-file-pdf-box ")])],1),e(l.Z,{attrs:{fab:"",small:"",disabled:!t.licences,loading:t.loading3},on:{click:function(e){return t.downloadXLSX("xlsx")}}},[e(p.Z,{attrs:{dark:"",color:"green darken-2"}},[t._v(" mdi-microsoft-excel ")])],1),e(A.Z),e(l.Z,{attrs:{color:"blue darken-3 white--text",loading:t.loading},on:{click:function(e){t.generateReport(),t.loading=!0}}},[t._v(" Gerar Relatório ")])],1)],1)],1)],1)],1),e(v.Z,[!0===t.showReport?e(r.Z,[e(d.Z,{attrs:{headers:t.headers,items:t.licences,"footer-props":{itemsPerPageOptions:[5,10,-1]}}})],1):t._e()],1)],1),e("vue-html2pdf",{ref:"html2Pdf",attrs:{"show-layout":!1,"enable-download":!0,"manual-pagination":!1,"paginate-elements-by-height":14001,filename:t.reportName,"pdf-quality":2,"pdf-format":"a4","pdf-orientation":"landscape","pdf-content-width":"100%"},on:{startPagination:function(e){t.loading2=!0},hasDownloaded:function(e){t.loading2=!1}}},[e("section",{attrs:{slot:"pdf-content"},slot:"pdf-content"},[!0===t.showReport?e(r.Z,[e(d.Z,{attrs:{headers:t.headers,items:t.licences,"footer-props":{itemsPerPageOptions:[-1]}}})],1):t._e()],1)]),e("table",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"exportableTable"},[e("tr",t._l(t.headers,(function(a,s){return e("th",{key:"header"+s},[t._v(" "+t._s(a.text)+" ")])})),0),t._l(t.licences,(function(a,s){return e("tr",{key:"data"+s},[e("td",[t._v(t._s(a.ID))]),e("td",[t._v(t._s(t.usDate(a.DATA)))]),e("td",[t._v(t._s(a.SOLICITANTE))]),e("td",[t._v(t._s(a.EMPRESA))]),e("td",[t._v(t._s(a.ESTADO))]),e("td",[t._v(t._s(a.PLACA))]),e("td",[t._v(t._s(a.NUMTAXA))])])}))],2)],1)},D=[],b=a(594),T=a(2074),E=a(4105),P={name:"FinancialReportStaff",components:{VueHtml2pdf:T.Z},data:()=>({company:"",aetState:"",plate:"",aetStatus:"",table:"",dateFormatted:"",reportName:"",showReport:!1,licences:null,loading:!1,loading2:!1,loading3:!1,date1:new Date((new Date).getFullYear(),(new Date).getMonth(),1).toISOString().substr(0,10),date2:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),companies:[],aetStates:[{value:"",text:"Selecione"},{value:"FEDERAL",text:"FEDERAL"},{value:"BA",text:"Bahia"},{value:"GO",text:"Goiás"},{value:"MG",text:"Minas Gerais"},{value:"MS",text:"Mato Grosso do Sul"},{value:"PE",text:"Pernambuco"},{value:"PR",text:"Paraná"},{value:"RJ",text:"Rio de Janiero"},{value:"RS",text:"Rio Grande do Sul"},{value:"SC",text:"Santa Catarina"},{value:"SP",text:"São Paulo"},{value:"TO",text:"Tocantins"},{value:"AC",text:"Acre"},{value:"AL",text:"Alagoas"},{value:"AM",text:"Amazonas"},{value:"AP",text:"Amapá"},{value:"CE",text:"Ceará"},{value:"DF",text:"Distrito Federal"},{value:"ES",text:"Espirito Santo"},{value:"MA",text:"Maranhão"},{value:"MT",text:"Mato Grosso"},{value:"PA",text:"Pará"},{value:"PB",text:"Paraíba"},{value:"PI",text:"Piauí"},{value:"RN",text:"Rio Grande do Norte"},{value:"RO",text:"Rondônia"},{value:"RR",text:"Roraima"},{value:"SE",text:"Sergipe"}],headers:[{text:"ID",value:"ID"},{text:"Data",value:"DATA"},{text:"Status",value:"SOLICITANTE"},{text:"Empresa",value:"EMPRESA"},{text:"Placa",value:"PLACA"},{text:"UF",value:"ESTADO"},{text:"Taxa",value:"NUMTAXA"}],statuses:["TAXA","Não Saiu Nada","Emitido"]}),computed:{computedDateFormatted1(){return this.formatDate(this.date1)},computedDateFormatted2(){return this.formatDate(this.date2)}},watch:{company(){let t=this.companies.filter((t=>t.EMPRESA===this.company));return this.plates=t,this.plates},date1(){this.dateFormatted=this.formatDate(this.date1)},date2(){this.dateFormatted=this.formatDate(this.date2)},licences(){return this.reportName="Relatório NVS "+this.date2}},created(){this.fetchCompanies()},methods:{fetchCompanies(){return fetch("https://sheetdb.io/api/v1/afxq0nl1f0gvg").then((t=>t.json())).then((t=>{this.companies=t}))},formatDate(t){if(!t)return null;var[e,a,s]=t.split("-");return`${s.padStart(2,"0")}/${a.padStart(2,"0")}/${e}`},parseDate(t){if(!t)return null;const[e,a,s]=t.split("/");return`${s}-${a.padStart(2,"0")}-${e.padStart(2,"0")}`},usDate(t){if(!t)return null;const[e,a,s]=t.split("/");var l="00:00:28";return`${a.padStart(2,"0")}/${e.padStart(2,"0")}/${s} ${l}`},fetchLicences(){return b.Z.get("https://sheetdb.io/api/v1/afxq0nl1f0gvg")},generateReport(){this.fetchLicences().then((t=>{var e=t.data;this.$nextTick((()=>{var t="",a="",s="",l="";t=e.filter((t=>t.EMPRESA.includes(this.company)&&t.PLACA.includes(this.plate)&&t.ESTADO.includes(this.aetState)&&t.STATUS.includes(this.status)&&this.parseDate(t.DATA).replace(/-/g,"")>=this.date1.replace(/-/g,"")&&this.parseDate(t.DATA).replace(/-/g,"")<=this.date2.replace(/-/g,""))),a=e.filter((t=>t.EMPRESA.includes(this.company)&&t.PLACA.includes(this.plate)&&t.ESTADO.includes(this.aetState)&&t.STATUS.includes(this.status[0])&&this.parseDate(t.DATA).replace(/-/g,"")>=this.date1.replace(/-/g,"")&&this.parseDate(t.DATA).replace(/-/g,"")<=this.date2.replace(/-/g,""))),s=e.filter((t=>t.EMPRESA.includes(this.company)&&t.PLACA.includes(this.plate)&&t.ESTADO.includes(this.aetState)&&t.STATUS.includes(this.status[1])&&this.parseDate(t.DATA).replace(/-/g,"")>=this.date1.replace(/-/g,"")&&this.parseDate(t.DATA).replace(/-/g,"")<=this.date2.replace(/-/g,""))),l=e.filter((t=>t.EMPRESA.includes(this.company)&&t.PLACA.includes(this.plate)&&t.ESTADO.includes(this.aetState)&&t.STATUS.includes(this.status[2])&&this.parseDate(t.DATA).replace(/-/g,"")>=this.date1.replace(/-/g,"")&&this.parseDate(t.DATA).replace(/-/g,"")<=this.date2.replace(/-/g,""))),0===this.status.length?this.licences=t:this.licences=a.concat(s).concat(l),this.showReport=!0,this.loading=!1}))}))},downloadPDF(){this.$refs.html2Pdf.generatePdf()},downloadXLSX(t,e,a){var s=this.$refs.exportableTable,l=E.P6.table_to_book(s,{sheet:"Relatório"});this.loading3=!0,setTimeout((()=>(this.loading3=!1,a?E.cW(l,{bookType:t,bookSTT:!0,type:"string"}):E.NC(l,e||this.reportName+"."+(t||"xlsx")))),100)}}},R=P,Z=a(1001),_=(0,Z.Z)(R,g,D,!1,null,null,null),w=_.exports}}]);
//# sourceMappingURL=views-FinancialReportStaff.e67c3f1c.js.map